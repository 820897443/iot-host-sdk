ARM GAS  /tmp/ccDR9dod.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"Retarget.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text._read,"ax",%progbits
  18              		.align	1
  19              		.global	_read
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv4-sp-d16
  25              	_read:
  26              	.LFB128:
  27              		.file 1 "Platform/STM32F4xx/peripherals/Retarget.c"
   1:Platform/STM32F4xx/peripherals/Retarget.c **** /***
   2:Platform/STM32F4xx/peripherals/Retarget.c ****  * File: retarget.c
   3:Platform/STM32F4xx/peripherals/Retarget.c ****  * porting iar project to keil, something need to do.
   4:Platform/STM32F4xx/peripherals/Retarget.c ****  *
   5:Platform/STM32F4xx/peripherals/Retarget.c ****  * Created by JerryYu @ Jan 13rd,2015
   6:Platform/STM32F4xx/peripherals/Retarget.c ****  * Ver: 0.1
   7:Platform/STM32F4xx/peripherals/Retarget.c ****  * */
   8:Platform/STM32F4xx/peripherals/Retarget.c **** 
   9:Platform/STM32F4xx/peripherals/Retarget.c **** #include <string.h> /* strlen */
  10:Platform/STM32F4xx/peripherals/Retarget.c **** #include <stdio.h>  /* snprintf */
  11:Platform/STM32F4xx/peripherals/Retarget.c **** #include "mx_hal.h"
  12:Platform/STM32F4xx/peripherals/Retarget.c **** 
  13:Platform/STM32F4xx/peripherals/Retarget.c **** #ifndef USE_GCC_PLATFORM
  14:Platform/STM32F4xx/peripherals/Retarget.c **** /********重写fputc********/
  15:Platform/STM32F4xx/peripherals/Retarget.c **** int fputc(int ch, FILE *f)
  16:Platform/STM32F4xx/peripherals/Retarget.c **** {
  17:Platform/STM32F4xx/peripherals/Retarget.c ****      unsigned char temp[1]={ch};
  18:Platform/STM32F4xx/peripherals/Retarget.c ****      HAL_UART_Transmit( &stdio_uart, temp, 1, 0x02 );
  19:Platform/STM32F4xx/peripherals/Retarget.c **** //   HAL_UART_Transmit( &huart2, ( uint8_t* )&ch, 1, 0 );
  20:Platform/STM32F4xx/peripherals/Retarget.c ****     return (ch);
  21:Platform/STM32F4xx/peripherals/Retarget.c **** }
  22:Platform/STM32F4xx/peripherals/Retarget.c **** 
  23:Platform/STM32F4xx/peripherals/Retarget.c **** /********重写fgetc********/
  24:Platform/STM32F4xx/peripherals/Retarget.c **** int fgetc(FILE *f)
  25:Platform/STM32F4xx/peripherals/Retarget.c **** {
  26:Platform/STM32F4xx/peripherals/Retarget.c ****     unsigned char  ch;
  27:Platform/STM32F4xx/peripherals/Retarget.c ****     HAL_UART_Receive(&stdio_uart,(uint8_t *)&ch, 1, 0);
  28:Platform/STM32F4xx/peripherals/Retarget.c ****     return  ch;
  29:Platform/STM32F4xx/peripherals/Retarget.c **** }
  30:Platform/STM32F4xx/peripherals/Retarget.c **** #else
  31:Platform/STM32F4xx/peripherals/Retarget.c **** extern int errno;
ARM GAS  /tmp/ccDR9dod.s 			page 2


  32:Platform/STM32F4xx/peripherals/Retarget.c **** 
  33:Platform/STM32F4xx/peripherals/Retarget.c **** /* read
  34:Platform/STM32F4xx/peripherals/Retarget.c ****  * Read a character to a file. `libc' subroutines will use this system routine for input from all f
  35:Platform/STM32F4xx/peripherals/Retarget.c ****  * Returns -1 on error or blocks until the number of characters have been read.
  36:Platform/STM32F4xx/peripherals/Retarget.c ****  */
  37:Platform/STM32F4xx/peripherals/Retarget.c **** 
  38:Platform/STM32F4xx/peripherals/Retarget.c **** int _read( int file, char *ptr, int len )
  39:Platform/STM32F4xx/peripherals/Retarget.c **** {
  28              		.loc 1 39 0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              	.LVL0:
  40:Platform/STM32F4xx/peripherals/Retarget.c ****     if( 2<file )
  33              		.loc 1 40 0
  34 0000 0228     		cmp	r0, #2
  35 0002 09DC     		bgt	.L3
  39:Platform/STM32F4xx/peripherals/Retarget.c ****     if( 2<file )
  36              		.loc 1 39 0
  37 0004 10B5     		push	{r4, lr}
  38              	.LCFI0:
  39              		.cfi_def_cfa_offset 8
  40              		.cfi_offset 4, -8
  41              		.cfi_offset 14, -4
  42 0006 1446     		mov	r4, r2
  41:Platform/STM32F4xx/peripherals/Retarget.c ****     {
  42:Platform/STM32F4xx/peripherals/Retarget.c ****         return -1;
  43:Platform/STM32F4xx/peripherals/Retarget.c ****     }
  44:Platform/STM32F4xx/peripherals/Retarget.c **** 
  45:Platform/STM32F4xx/peripherals/Retarget.c ****     HAL_UART_Receive(&stdio_uart,(uint8_t *)ptr, len, 0xFFFFFFFF);
  43              		.loc 1 45 0
  44 0008 4FF0FF33 		mov	r3, #-1
  45 000c 92B2     		uxth	r2, r2
  46              	.LVL1:
  47 000e 0448     		ldr	r0, .L8
  48              	.LVL2:
  49 0010 FFF7FEFF 		bl	HAL_UART_Receive
  50              	.LVL3:
  46:Platform/STM32F4xx/peripherals/Retarget.c ****     
  47:Platform/STM32F4xx/peripherals/Retarget.c ****     return len;
  51              		.loc 1 47 0
  52 0014 2046     		mov	r0, r4
  48:Platform/STM32F4xx/peripherals/Retarget.c **** }
  53              		.loc 1 48 0
  54 0016 10BD     		pop	{r4, pc}
  55              	.LVL4:
  56              	.L3:
  57              	.LCFI1:
  58              		.cfi_def_cfa_offset 0
  59              		.cfi_restore 4
  60              		.cfi_restore 14
  42:Platform/STM32F4xx/peripherals/Retarget.c ****     }
  61              		.loc 1 42 0
  62 0018 4FF0FF30 		mov	r0, #-1
  63              	.LVL5:
  64              		.loc 1 48 0
  65 001c 7047     		bx	lr
ARM GAS  /tmp/ccDR9dod.s 			page 3


  66              	.L9:
  67 001e 00BF     		.align	2
  68              	.L8:
  69 0020 00000000 		.word	stdio_uart
  70              		.cfi_endproc
  71              	.LFE128:
  73              		.section	.text._write,"ax",%progbits
  74              		.align	1
  75              		.global	_write
  76              		.syntax unified
  77              		.thumb
  78              		.thumb_func
  79              		.fpu fpv4-sp-d16
  81              	_write:
  82              	.LFB129:
  49:Platform/STM32F4xx/peripherals/Retarget.c **** 
  50:Platform/STM32F4xx/peripherals/Retarget.c **** /* write
  51:Platform/STM32F4xx/peripherals/Retarget.c ****  * Write a character to a file. `libc' subroutines will use this system routine for output to all f
  52:Platform/STM32F4xx/peripherals/Retarget.c ****  * Returns -1 on error or number of bytes sent
  53:Platform/STM32F4xx/peripherals/Retarget.c ****  */
  54:Platform/STM32F4xx/peripherals/Retarget.c **** 
  55:Platform/STM32F4xx/peripherals/Retarget.c **** int _write( int file, char *ptr, int len )
  56:Platform/STM32F4xx/peripherals/Retarget.c **** {
  83              		.loc 1 56 0
  84              		.cfi_startproc
  85              		@ args = 0, pretend = 0, frame = 0
  86              		@ frame_needed = 0, uses_anonymous_args = 0
  87              	.LVL6:
  57:Platform/STM32F4xx/peripherals/Retarget.c **** 	if( 2<file )
  88              		.loc 1 57 0
  89 0000 0228     		cmp	r0, #2
  90 0002 08DC     		bgt	.L12
  56:Platform/STM32F4xx/peripherals/Retarget.c **** 	if( 2<file )
  91              		.loc 1 56 0
  92 0004 10B5     		push	{r4, lr}
  93              	.LCFI2:
  94              		.cfi_def_cfa_offset 8
  95              		.cfi_offset 4, -8
  96              		.cfi_offset 14, -4
  97 0006 1446     		mov	r4, r2
  58:Platform/STM32F4xx/peripherals/Retarget.c ****     {
  59:Platform/STM32F4xx/peripherals/Retarget.c ****         return -1;
  60:Platform/STM32F4xx/peripherals/Retarget.c ****     }
  61:Platform/STM32F4xx/peripherals/Retarget.c **** 
  62:Platform/STM32F4xx/peripherals/Retarget.c ****     HAL_UART_Transmit( &stdio_uart, (const char*)ptr, len, 0x02 );
  98              		.loc 1 62 0
  99 0008 0223     		movs	r3, #2
 100 000a 92B2     		uxth	r2, r2
 101              	.LVL7:
 102 000c 0348     		ldr	r0, .L17
 103              	.LVL8:
 104 000e FFF7FEFF 		bl	HAL_UART_Transmit
 105              	.LVL9:
  63:Platform/STM32F4xx/peripherals/Retarget.c **** 
  64:Platform/STM32F4xx/peripherals/Retarget.c ****     return len;
 106              		.loc 1 64 0
 107 0012 2046     		mov	r0, r4
ARM GAS  /tmp/ccDR9dod.s 			page 4


  65:Platform/STM32F4xx/peripherals/Retarget.c **** }
 108              		.loc 1 65 0
 109 0014 10BD     		pop	{r4, pc}
 110              	.LVL10:
 111              	.L12:
 112              	.LCFI3:
 113              		.cfi_def_cfa_offset 0
 114              		.cfi_restore 4
 115              		.cfi_restore 14
  59:Platform/STM32F4xx/peripherals/Retarget.c ****     }
 116              		.loc 1 59 0
 117 0016 4FF0FF30 		mov	r0, #-1
 118              	.LVL11:
 119              		.loc 1 65 0
 120 001a 7047     		bx	lr
 121              	.L18:
 122              		.align	2
 123              	.L17:
 124 001c 00000000 		.word	stdio_uart
 125              		.cfi_endproc
 126              	.LFE129:
 128              		.text
 129              	.Letext0:
 130              		.file 2 "/home/wumingju/Documents/aos/AliOS-Things/build/compiler/gcc-arm-none-eabi/Linux64/arm-no
 131              		.file 3 "/home/wumingju/Documents/aos/AliOS-Things/build/compiler/gcc-arm-none-eabi/Linux64/arm-no
 132              		.file 4 "/home/wumingju/Documents/aos/AliOS-Things/build/compiler/gcc-arm-none-eabi/Linux64/arm-no
 133              		.file 5 "/home/wumingju/Documents/aos/AliOS-Things/build/compiler/gcc-arm-none-eabi/Linux64/lib/gc
 134              		.file 6 "/home/wumingju/Documents/aos/AliOS-Things/build/compiler/gcc-arm-none-eabi/Linux64/arm-no
 135              		.file 7 "/home/wumingju/Documents/aos/AliOS-Things/build/compiler/gcc-arm-none-eabi/Linux64/arm-no
 136              		.file 8 "/home/wumingju/Documents/aos/AliOS-Things/build/compiler/gcc-arm-none-eabi/Linux64/arm-no
 137              		.file 9 "/home/wumingju/Documents/aos/AliOS-Things/build/compiler/gcc-arm-none-eabi/Linux64/arm-no
 138              		.file 10 "Platform/STM32F4xx/drivers/CMSIS/Include/core_cm4.h"
 139              		.file 11 "Platform/STM32F4xx/drivers/CMSIS/Device/ST/STM32F4xx/Include/system_stm32f4xx.h"
 140              		.file 12 "Platform/STM32F4xx/drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f411xe.h"
 141              		.file 13 "Platform/STM32F4xx/drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 142              		.file 14 "Platform/STM32F4xx/drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 143              		.file 15 "Platform/STM32F4xx/drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_uart.h"
 144              		.file 16 "Platform/STM32F4xx/peripherals/mx_hal.h"
ARM GAS  /tmp/ccDR9dod.s 			page 5


DEFINED SYMBOLS
                            *ABS*:0000000000000000 Retarget.c
     /tmp/ccDR9dod.s:18     .text._read:0000000000000000 $t
     /tmp/ccDR9dod.s:25     .text._read:0000000000000000 _read
     /tmp/ccDR9dod.s:69     .text._read:0000000000000020 $d
     /tmp/ccDR9dod.s:74     .text._write:0000000000000000 $t
     /tmp/ccDR9dod.s:81     .text._write:0000000000000000 _write
     /tmp/ccDR9dod.s:124    .text._write:000000000000001c $d

UNDEFINED SYMBOLS
HAL_UART_Receive
stdio_uart
HAL_UART_Transmit
